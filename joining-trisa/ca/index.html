<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><meta name=description content="The TRISA PKI Infrastructure"><link rel=icon href=/favicon.png type=image/png><title>Certificate Authority :: TRISA Documentation</title><link href=/css/nucleus.css?1658174736 rel=stylesheet><link href=/css/fontawesome-all.min.css?1658174736 rel=stylesheet><link href=/css/featherlight.min.css?1658174736 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1658174736 rel=stylesheet><link href=/css/auto-complete.css?1658174736 rel=stylesheet><link href=/css/theme.css?1658174736 rel=stylesheet><link href=/css/theme-blue.css?1658174736 rel=stylesheet><link href=/css/variant.css?1658174736 rel=stylesheet><link href=/css/print.css?1658174736 rel=stylesheet media=print><script src=/js/jquery.min.js?1658174736></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=/joining-trisa/ca/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/ style="color:#3d414d;font-family:novacento sans wide,helvetica,tahoma,geneva,arial,sans-serif;font-size:30px;font-weight:700;margin-top:-2px"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="110pt" height="100pt" viewBox="0 0 1116 1022"><g transform="translate(0.000000,1022.000000) scale(0.100000,-0.100000)" fill="#fff" stroke="none"><path d="M5175 8694c-372-40-646-124-955-289-93-50-98-53-185-109-79-52-172-124-270-211l-80-71-45 8c-119 24-255-17-338-1e2-138-139-147-353-21-513 96-123 314-160 462-81 67 36 141 120 166 187 29 76 29 214 1 280l-20 46 53 50c28 27 93 80 142 118 319 239 7e2 388 1106 431 123 13 410 13 524 0 455-52 915-256 1233-547l53-48-20-60c-10-33-22-71-25-85-4-21-24-33-121-74-514-217-929-608-1212-1141l-53-1e2v457 456l48 27c108 62 171 149 192 264 30 169-51 336-199 408-51 25-66 28-166 28-106 0-112-1-171-33-75-41-123-89-160-162-27-51-29-63-29-170s2-119 28-168c33-63 101-131 163-163l44-24v-841-841l-40-18c-52-24-145-121-172-182-17-38-21-68-22-148-1-88 2-107 26-157 83-177 275-258 466-196 58 18 77 31 138 92s73 79 87 132c33 119 16 254-44 341-29 42-94 1e2-137 122-12 7-20 16-17 21 3 4 12 46 21 92 24 130 72 290 126 428 43 108 204 408 250 465 4 6 34 44 65 85 242 316 561 565 903 704l64 26 41-39c22-22 67-53 1e2-68 53-25 71-28 160-28 91 0 106 3 158 30 136 68 213 202 205 353-8 147-77 257-2e2 317-61 31-197 45-259 27-35-9-39-8-80 30-24 23-60 55-79 73-29 26-92 75-185 143-5 4-30 20-55 36s-58 38-73 48c-42 29-250 134-305 154-26 10-51 20-57 24-30 20-248 87-363 111-303 65-595 83-867 53z"/><path d="M5901 4195c-67-15-98-31-144-74-84-77-97-212-31-314 45-69 1e2-95 357-168 114-32 150-82 110-150-36-61-165-89-246-55-43 17-84 67-97 117l-11 40-92-7c-51-3-94-8-96-10-8-7 20-111 40-150 66-124 204-185 388-171 213 17 321 115 321 290 0 165-78 239-320 302-175 45-220 73-206 131 20 79 210 94 271 22 14-17 29-44 32-60 5-27 9-29 36-24 16 3 61 6 99 6h70l-7 43c-4 23-14 59-22 80-21 53-104 123-166 142-75 23-209 28-286 10z"/><path d="M3570 4110v-80h135 135v-380-380h1e2 1e2v380 380h135 135v80 80h-370-370v-80z"/><path d="M4420 3731v-461h95 95v190 190h39c107 0 124-14 269-228l103-152h115c62 0 114 2 114 5s-41 69-90 148c-61 95-110 161-151 2e2-47 44-57 57-42 57 34 0 96 30 131 63 126 120 98 339-53 416-49 26-51 26-337 29l-288 4v-461zm5e2 281c25-12 39-28 49-58 13-37 12-44-5-80-10-21-30-44-44-50-14-7-89-15-167-19l-143-7v116 116h138c110 0 144-3 172-18z"/><path d="M5340 3730v-460h95 95v460 460h-95-95v-460z"/><path d="M6792 4138c-11-29-90-233-176-452-86-220-156-404-156-408 0-5 46-7 102-6l103 3 36 1e2 36 1e2h179 178l39-102 40-103h103c57 0 104 3 104 8 0 4-81 211-181 460l-181 452h-103-104l-19-52zm176-328c28-74 53-143 57-152 7-17-2-18-109-18-64 0-116 1-116 3 0 14 112 309 115 305 2-2 26-64 53-138z"/><path d="M9e2 2194v-466l243 4c275 5 316 14 399 88 174 153 186 548 22 730-82 90-163 109-466 110H9e2v-466zm455 277c51-23 91-69 107-124 19-65 16-261-5-323-19-55-56-97-1e2-113-16-6-80-11-143-11h-114v295 295h108c82 0 116-5 147-19z"/><path d="M8290 2575v-85h90 90v85 85h-90-90v-85z"/><path d="M6818 2587l-88-52v-67-68h-40-40v-70-70h39 38l5-212c6-252 13-278 80-308 48-22 140-26 201-9 34 9 37 13 37 47 0 72-11 113-29 108-55-16-69-17-85-1-14 14-16 43-16 196v179h60 60v70 70h-60-60v120c0 66-3 120-7 119-5 0-47-24-95-52z"/><path d="M7958 2587l-88-51v-68-68h-40-40v-70-70h39 39l4-217c3-245 9-268 78-304 40-22 141-26 203-8l39 10-7 72c-4 40-9 74-10 75-2 2-19-1-39-8-26-8-41-8-56 0-19 10-20 19-20 195v185h60 60v70 70h-60-60v120c0 66-3 120-7 120-5-1-47-24-95-53z"/><path d="M2013 2402c-151-54-227-166-227-332 1-206 121-337 320-348 157-9 267 51 334 182 33 64 35 74 35 165-1 82-4 104-26 151-37 79-81 125-156 162-83 41-198 49-280 20zm196-160c61-45 90-128 76-215-10-56-28-89-65-121-61-51-132-47-191 12-91 91-65 289 45 338 39 18 101 11 135-14z"/><path d="M2773 2402c-89-32-143-84-180-173-14-34-18-71-18-164 0-111 2-124 28-177 55-111 153-168 291-168 137 0 220 45 273 148 49 95 48 97-56 114l-89 14-11-36c-15-51-51-81-103-87-94-9-148 64-148 202 0 134 44 195 139 195 46 0 95-35 105-75 4-14 12-25 19-24 27 1 158 27 163 32 10 10-15 73-46 115-44 61-122 95-229 99-65 3-99-1-138-15z"/><path d="M4375 2408c-16-6-48-24-70-40l-40-29-3 31-3 30h-90-89v-335-335h95 95v203c0 111 4 219 9 240 24 102 152 141 191 59 9-18 14-103 18-264l5-238h87 88l4 223c3 189 6 227 21 254 38 70 120 90 163 39 24-27 24-29 24-272v-244h95 95v251c0 287-6 325-60 379-83 83-254 77-338-13l-23-24-37 37c-55 55-158 76-237 48z"/><path d="M5389 2404c-59-18-133-83-164-144s-48-168-39-245c14-127 67-215 158-263 46-25 61-27 161-27s115 2 161 27c70 37 144 128 131 162-3 7-42 18-88 25-78 12-85 12-94-5-26-47-63-74-102-74-68 0-118 45-137 123l-6 27h220 220v58c0 125-48 239-122 293-78 56-2e2 74-299 43zm178-150c29-18 49-51 58-91l7-33h-126-126v25c0 94 108 151 187 99z"/><path d="M6241 2406c-24-8-61-29-82-46l-39-31v36 35h-90-90v-335-335h94 95l3 223c4 258 8 275 84 309 54 23 91 18 125-18 24-25 24-28 27-270l3-244h95 95l-3 268c-3 257-4 269-26 315-33 65-90 99-180 103-40 2-84-2-111-10z"/><path d="M7292 2405c-81-23-130-67-157-144-11-31-11-41-2-41 7 0 45-6 85-14l73-14 15 30c20 40 73 61 129 52 50-7 72-27 81-71 7-35 18-30-156-69-202-46-250-89-250-221 0-42 6-67 25-99 63-107 255-127 371-39l32 24 6-34 7-35h96c87 0 94 2 88 18-30 71-35 115-35 296-1 264-11 298-104 345-62 31-221 39-304 16zm225-416c-4-49-11-67-33-90-69-72-173-58-190 27-10 53 23 74 181 112 22 6 42 10 44 11s1-26-2-60z"/><path d="M8836 2404c-167-53-255-209-226-397 19-127 75-206 180-256 48-23 67-26 160-26 91 0 112 3 155 24 59 30 126 94 154 149 70 138 39 341-68 434-87 77-242 108-355 72zm161-145c102-38 146-212 80-311-87-128-244-90-277 67s75 290 197 244z"/><path d="M9715 2404c-22-8-57-28-77-45l-38-30v36 35h-90-90v-335-335h94 95l3 223c3 257 8 275 83 308 52 23 94 17 127-18 23-24 23-29 26-269l3-244h95 96l-4 268c-3 264-3 268-28 317-20 38-37 55-75 74-60 31-160 38-220 15z"/><path d="M3312 2138c4-292 8-309 71-365 48-42 97-56 176-51 71 5 120 25 164 66l27 26v-42-42h90 90v335 335h-94-95l-3-223c-3-193-5-227-21-250-24-36-59-58-105-64-33-4-44-1-73 25l-34 30-3 241-3 241h-95-96l4-262z"/><path d="M8290 2065v-335h90 90v335 335h-90-90v-335z"/></g></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/js/lunr.min.js?1658174736></script><script src=/js/auto-complete.js?1658174736></script><script>var index_url="/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/js/search.js?1658174736></script></div><div id=homelinks><ul><li><a class=padding href=/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/getting-started/ title="Getting Started" class=dd-item><a href=/getting-started/>Getting Started</a><ul><li data-nav-id=/getting-started/protocol/ title="TRISA Protocol" class=dd-item><a href=/getting-started/protocol/>TRISA Protocol</a></li><li data-nav-id=/getting-started/api/ title="TRISA API" class=dd-item><a href=/getting-started/api/>TRISA API</a></li><li data-nav-id=/getting-started/errors/ title="TRISA Errors and Rejections" class=dd-item><a href=/getting-started/errors/>TRISA Errors and Rejections</a></li><li data-nav-id=/getting-started/keys/ title="Key Handler Package" class=dd-item><a href=/getting-started/keys/>Key Handler Package</a></li></ul></li><li data-nav-id=/joining-trisa/ title="Joining TRISA" class="dd-item parent"><a href=/joining-trisa/>Joining TRISA</a><ul><li data-nav-id=/joining-trisa/registration/ title=Registration class=dd-item><a href=/joining-trisa/registration/>Registration</a></li><li data-nav-id=/joining-trisa/trixo/ title="TRIXO Form" class=dd-item><a href=/joining-trisa/trixo/>TRIXO Form</a></li><li data-nav-id=/joining-trisa/pkcs12/ title="Anatomy of a PKCS12 file" class=dd-item><a href=/joining-trisa/pkcs12/>Anatomy of a PKCS12 file</a></li><li data-nav-id=/joining-trisa/ca/ title="Certificate Authority" class="dd-item active"><a href=/joining-trisa/ca/>Certificate Authority</a></li></ul></li><li data-nav-id=/secure-envelopes/ title="Secure Envelopes" class=dd-item><a href=/secure-envelopes/>Secure Envelopes</a><ul></ul></li><li data-nav-id=/data-payloads/ title="Data Payloads" class=dd-item><a href=/data-payloads/>Data Payloads</a><ul></ul></li><li data-nav-id=/ivms/ title="Working with IVMS101" class=dd-item><a href=/ivms/>Working with IVMS101</a><ul></ul></li><li data-nav-id=/testnet/ title="TestNet Integration and Development" class=dd-item><a href=/testnet/>TestNet Integration and Development</a><ul><li data-nav-id=/testnet/rvasps/ title="Robot VASPs" class=dd-item><a href=/testnet/rvasps/>Robot VASPs</a></li><li data-nav-id=/testnet/trisa-cli/ title="TRISA CLI" class=dd-item><a href=/testnet/trisa-cli/>TRISA CLI</a></li><li data-nav-id=/testnet/certs-cli/ title="Creating Test Certificates" class=dd-item><a href=/testnet/certs-cli/>Creating Test Certificates</a></li></ul></li><li data-nav-id=/gds/ title="Directory Service" class=dd-item><a href=/gds/>Directory Service</a><ul><li data-nav-id=/gds/api/ title="Using the GDS API" class=dd-item><a href=/gds/api/>Using the GDS API</a></li><li data-nav-id=/gds/members/ title="Accessing Members" class=dd-item><a href=/gds/members/>Accessing Members</a></li></ul></li><li data-nav-id=/contributing/ title=Contributing class=dd-item><a href=/contributing/>Contributing</a><ul><li data-nav-id=/contributing/how-to-contribute/ title="How to Contribute" class=dd-item><a href=/contributing/how-to-contribute/>How to Contribute</a></li><li data-nav-id=/contributing/license/ title=License class=dd-item><a href=/contributing/license/>License</a></li></ul></li><li data-nav-id=/reference/ title=Reference class=dd-item><a href=/reference/>Reference</a><ul><li data-nav-id=/reference/faq/ title=FAQ class=dd-item><a href=/reference/faq/>FAQ</a></li><li data-nav-id=/reference/glossary/ title=Glossary class=dd-item><a href=/reference/glossary/>Glossary</a></li><li data-nav-id=/reference/best-practices/ title="Best Practices" class=dd-item><a href=/reference/best-practices/>Best Practices</a></li></ul></li></ul><div id=shortcuts><div class=nav-title></div><ul><li><a class=padding href=https://github.com/trisacrypto/trisa><i class="fab fa-fw fa-github"></i> Version v1beta1</a></li><li><a class=padding href=https://pkg.go.dev/github.com/trisacrypto/trisa/pkg><i class="fas fa-book"></i> TRISA API Documentation</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://trisa.dev/joining-trisa/ca/ selected>English</option><option id=de value=https://trisa.dev/de/joining-trisa/ca/>Deutsch</option><option id=fr value=https://trisa.dev/fr/joining-trisa/ca/>Français</option><option id=zh value=https://trisa.dev/zh/joining-trisa/ca/>中文</option><option id=ja value=https://trisa.dev/ja/joining-trisa/ca/>日本語</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3"><a itemprop=item href=/><span itemprop=name>Home</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="2"><a itemprop=item href=/joining-trisa/><span itemprop=name>Joining TRISA</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="1"><a itemprop=item href=/joining-trisa/ca/ aria-disabled=true><span itemprop=name>Certificate Authority</span></a></li></ol></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#the-sectigo-ca-api>The Sectigo CA API</a><ul><li><a href=#getting-started>Getting Started</a></li><li><a href=#authentication>Authentication</a></li><li><a href=#authorities-and-profiles>Authorities and Profiles</a></li><li><a href=#creating-certificates>Creating Certificates</a></li><li><a href=#uploading-a-csr>Uploading a CSR</a></li><li><a href=#managing-certificates>Managing Certificates</a></li></ul></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Certificate Authority</h1><p>TRISA is unique amongst open source Travel Rule protocols in that it is a <strong>trusted network</strong>, meaning that all communications are protected. TRISA uses mTLS (mutual transport layer security) to protect communications between peers. In addition to helping protect against malicious API requests, mTLS can prevent spoofing and phishing, as well as brute force and on-path attacks.</p><p>mTLS requires that both peers in an interaction have Identity Certificates with a mutually-recognized root Certificate Authority (CA). This root CA is necessary to enhance trust and ensure that private client data is being sent to the correct party.</p><p>Imagine two VASPs that wish to exchange Travel Rule data, Alice and Bob. When Alice registers for TRISA, it receives Identity Certificates, which serve as proof to Bob that Alice is who it says it is, and vice versa:</p><p><img src=/img/trisa-pki.jpg alt="TRISA PKI infrastructure"></p><ol><li>First, Alice looks Bob up in the Global Directory Serice to retrieve its endpoint and public key.</li><li>Alice then presents it&rsquo;s own Identity Certificates to Bob&rsquo;s endpoint via an mTLS connection.</li><li>Bob can then verify that Alice&rsquo;s certs are signed by the TRISA root Certificate Authority.</li><li>Bob looks up Alice and verifies its certificates and endpoint details in the Global Directory Service.</li><li>Bob presents it&rsquo;s Identity Certificates to Alice&rsquo;s endpoint via mTLS.</li><li>Alice can then verify that Bob&rsquo;s certs are signed by the TRISA root Certificate Authority.</li><li>Alice confirms that Bob&rsquo;s certificate details match those in the Global Directory Service.</li><li>Now that both parties are satisfied that they can trust each other with private customer data, they proceed with a Travel Rule information exchange.</li></ol><h2 id=the-sectigo-ca-api>The Sectigo CA API</h2><div class="notices warning"><div class=label>Warning</div><p>This portion of the documentation is targeted at TRISA developers rather than TRISA implementers. For the most part, the mechanics of certificate issuance will be fully abstracted away from TRISA implementers, who are encouraged to register for certificates using <a href=https://vaspdirectory.net/>vaspdirectory.net</a>.</p></div><p><a href=https://pkg.go.dev/github.com/trisacrypto/directory/pkg/sectigo><img src=https://pkg.go.dev/badge/github.com/trisacrypto/directory/pkg/sectigo.svg alt="Go Reference"></a></p><p>The TRISA Directory Service currently issues certificates using the Sectigo Certificate Authority via its IoT Portal. Because the directory service must collect public key material in order to facilitate an initial trusted handshake for mTLS, it uses the Sectigo IoT Manager API as part of the VASP registration and verification process. The <code>github.com/trisacrypto/directory/pkg/sectigo</code> package is a Go library for interacting with the API, implementing the endpoints and methods required by the directory service. The TestNet also provides a command line utility for interacting with the API for administrative and debugging purposes.</p><p>This documentation describes the command line utility, which also gives an overview of how to use the API directly to issue and revoke certificates.</p><p>Reference material:</p><ul><li><a href=https://pkg.go.dev/github.com/trisacrypto/directory/pkg/sectigo>Package Documentation</a></li><li><a href="https://support.sectigo.com/Com_KnowledgeDetailPage?Id=kA01N000000bvCJ">IoT Manager API Documentation</a></li><li><a href=https://iot.sectigo.com>IoT Manager Portal</a></li></ul><h3 id=getting-started>Getting Started</h3><p>To install the <code>sectigo</code> CLI utility, either download a pre-compiled binary from the <a href=https://github.com/trisacrypto/directory/releases>releases on GitHub</a> or install locally using:</p><pre><code>$ go get github.com/trisacrypto/directory/cmd/sectigo
</code></pre><p>This will add the <code>sectigo</code> command to your <code>$PATH</code>.</p><h3 id=authentication>Authentication</h3><p>The first step is authentication, you should set your username and password in the <code>$SECTIGO_USERNAME</code> and <code>$SECTIGO_PASSWORD</code> environment variables (alternatively you can pass them as parameters on the command line). To verify your authentication status you can use:</p><pre><code>$ sectigo auth
</code></pre><p>The API authenticates by username and password then returns acess and refresh tokens which are stored in a local cache file. To see where your cache is stored:</p><pre><code>$ sectigo auth --cache
</code></pre><p>If you&rsquo;d like to check your credentials state, e.g. if the access tokens are valid, refreshable, or expired, use:</p><pre><code>$ sectigo auth --debug
</code></pre><h3 id=authorities-and-profiles>Authorities and Profiles</h3><p>To begin to interact with certificates you need to list the authorities and profiles that your user account has access to.</p><pre><code>$ sectigo authorities
[
  {
    &quot;id&quot;: 1,
    &quot;ecosystemId&quot;: 100,
    &quot;signerCertificateId&quot;: 0,
    &quot;ecosystemName&quot;: &quot;TRISA&quot;,
    &quot;balance&quot;: 10,
    &quot;enabled&quot;: true,
    &quot;profileId&quot;: 42,
    &quot;profileName&quot;: &quot;TRISA Profile&quot;
  }
]
</code></pre><p>The authority displays the methods and profiles that certificates are created under. Here the <code>profileId</code> field is very important for use in subsequent calls. You can also view how many licenses have been ordered/issued across all authorities as follows:</p><pre><code>$ sectigo licenses
{
  &quot;ordered&quot;: 2,
  &quot;issued&quot;: 2
}
</code></pre><p>To get detail information for a profile, use the profile ID with the following command:</p><pre><code>$ sectigo profiles -i 42
</code></pre><p>This will return the raw profile configuration. Before creating certificates with the authority, you&rsquo;ll need to know the required profile parameters:</p><pre><code>$ sectigo profile -i 42 --params
</code></pre><h3 id=creating-certificates>Creating Certificates</h3><p>You can request a certificate to be created with the <code>commonName</code> and <code>pkcs12Password</code> params as follows (note for profiles that require other params, you&rsquo;ll have to use the code base directly and implement your own method):</p><pre><code>$ sectigo create -a 42 -d example.com -p secrtpasswrd -b &quot;example.com certs&quot;
{
  &quot;batchId&quot;: 24,
  &quot;orderNumber&quot;: 1024,
  &quot;creationDate&quot;: &quot;2020-12-10T16:35:32.805+0000&quot;,
  &quot;profile&quot;: &quot;TRISA Profile&quot;,
  &quot;size&quot;: 1,
  &quot;status&quot;: &quot;CREATED&quot;,
  &quot;active&quot;: false,
  &quot;batchName&quot;: &quot;example.com certs&quot;,
  &quot;rejectReason&quot;: &quot;&quot;,
  &quot;generatorParametersValues&quot;: null,
  &quot;userId&quot;: 10,
  &quot;downloadable&quot;: true,
  &quot;rejectable&quot;: true
}
</code></pre><p>The <code>-a</code> flag specifies the authority, but should be a profile id. The domain must be a valid domain. If you don&rsquo;t specify a password, one is generated for you and printed on the CLI before exit. The <code>-b</code> flag gives a human readable name for the batch creation. The return data shows detail about the batch certificate job that was created; you can fetch the data to keep checking on the status as follows:</p><pre><code>$ sectigo batches -i 24
</code></pre><p>You can also get processing information for the batch:</p><pre><code>$ sectigo batches -i 24 --status
</code></pre><p>Once the batch is created, it&rsquo;s time to download the certificates in a ZIP file:</p><pre><code>$ sectigo download -i 24 -o certs/
</code></pre><p>This will download the batch file (usually batchId.zip, 24.zip in this case) to the <code>certs/</code> directory. Unzip the certs then decrypt the .pem file as follows:</p><pre><code>$ unzip certs/24.zip
$ openssl pkcs12 -in certs/example.com.p12 -out certs/example.com.pem -nodes
</code></pre><p>For more on working with the PKCS12 file, see <a href=https://www.ssl.com/how-to/export-certificates-private-key-from-pkcs12-file-with-openssl/>Export Certificates and Private Key from a PKCS#12 File with OpenSSL</a>.</p><h3 id=uploading-a-csr>Uploading a CSR</h3><p>An alternative to certificate creation is to upload a certificate signing request (CSR). This mechanism is often preferable because it means that no private key material has to be transmitted accross the network and the private key can remain on secure hardware.</p><p>To generate a CSR using <code>openssl</code> on the command line, first create a configuration file named <code>trisa.conf</code> in your current working directory, replacing <code>example.com</code> with the domain you plan to host your TRISA endpoint on:</p><pre><code class=language-conf data-lang=conf>[req]
distinguished_name = dn_req
req_extensions = v3ext_req
prompt = no
default_bits = 4096
[dn_req]
CN = example.com
O = [Organization]
L = [City]
ST = [State or Province (fully spelled out, no abbreviations)]
C = [2 digit country code]
[v3ext_req]
basicConstraints = CA:FALSE
keyUsage = digitalSignature, keyEncipherment, nonRepudiation
extendedKeyUsage = clientAuth, serverAuth
subjectAltName = @alt_names
[alt_names]
DNS.1 = example.com
</code></pre><p>Please carefully fill out the configuration for your certificate, this information must be correct and cannot be changed without reissuing the certificate. Also make sure that there are no spaces after the entries in the configuration!</p><p>Then run the following command, replacing <code>example.com</code> with the domain name you will be using as your TRISA endpoint:</p><pre><code>$ openssl req -new -newkey rsa:4096 -nodes -sha384 -config trisa.conf \
  -keyout example.com.key -out example.com.csr
</code></pre><p>You can then upload the CSR using the CLI program as follows:</p><pre><code>$ sectigo upload -p 42 &lt;common_name&gt;.csr
{
  &quot;batchId&quot;: 24,
  &quot;orderNumber&quot;: 1024,
  &quot;creationDate&quot;: &quot;2020-12-10T16:35:32.805+0000&quot;,
  &quot;profile&quot;: &quot;TRISA Profile&quot;,
  &quot;size&quot;: 1,
  &quot;status&quot;: &quot;CREATED&quot;,
  &quot;active&quot;: false,
  &quot;batchName&quot;: &quot;example.com certs&quot;,
  &quot;rejectReason&quot;: &quot;&quot;,
  &quot;generatorParametersValues&quot;: null,
  &quot;userId&quot;: 10,
  &quot;downloadable&quot;: true,
  &quot;rejectable&quot;: true
}
</code></pre><p>The <code>-p</code> flag specifies the profile to use the CSR batch request with and must be a valid profileId. The uploaded CSRs can be a single text file with multiple CSRs in PEM form using standard BEGIN/END separators.</p><h3 id=managing-certificates>Managing Certificates</h3><p>You can search for a certificate by name or serial number, but mostly commonly you search by the domain or common name to get the serial number:</p><pre><code>$ sectigo find -n example.com
</code></pre><p>Once you&rsquo;ve obtained the serial number you can revoke the certificate as follows:</p><pre><code>$ sectigo revoke -p 42 -r &quot;cessation of operation&quot; -s 12345
</code></pre><p>This command expects the profile id that issued the certificate with the <code>-p</code> flag, an <a href=https://tools.ietf.org/html/rfc5280#section-5.3.1>RFC 5280 reason code</a> passed via the <code>-r</code> flag (unspecified by default), and the serial number of the certificate using the <code>-s</code> flag. If this command doesn&rsquo;t error, then the certificate has been successfully revoked.</p><p>The RFC 5280 reasons are:</p><ul><li>&ldquo;unspecified&rdquo;</li><li>&ldquo;keycompromise&rdquo;</li><li>&ldquo;ca compromise&rdquo;</li><li>&ldquo;affiliation changed&rdquo;</li><li>&ldquo;superseded&rdquo;</li><li>&ldquo;cessation of operation&rdquo;</li><li>&ldquo;certificate hold&rdquo;</li><li>&ldquo;remove from crl&rdquo;</li><li>&ldquo;privilege withdrawn&rdquo;</li><li>&ldquo;aa compromise&rdquo;</li></ul><p>Note that the reason is whitespace and case insensitive.</p><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/joining-trisa/pkcs12/ title="Anatomy of a PKCS12 file"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/secure-envelopes/ title="Secure Envelopes"><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1658174736></script><script src=/js/perfect-scrollbar.min.js?1658174736></script><script src=/js/perfect-scrollbar.jquery.min.js?1658174736></script><script src=/js/jquery.svg.pan.zoom.js?1658174736></script><script src=/js/featherlight.min.js?1658174736></script><script src=/js/modernizr.custom-3.6.0.js?1658174736></script><script src=/js/mermaid.min.js?1658174736></script><script>typeof mermaid!='undefined'&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/js/relearn.js?1658174736></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-F9T1H8EJJS"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-F9T1H8EJJS')</script></body></html>