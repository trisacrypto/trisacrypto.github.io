<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><meta name=description content="Describing the TRISA API"><link rel=icon href=/favicon.png type=image/png><title>TRISA API :: TRISA Documentation</title><link href=/css/nucleus.css?1662767939 rel=stylesheet><link href=/css/fontawesome-all.min.css?1662767939 rel=stylesheet><link href=/css/featherlight.min.css?1662767939 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1662767939 rel=stylesheet><link href=/css/auto-complete.css?1662767939 rel=stylesheet><link href=/css/theme.css?1662767939 rel=stylesheet><link href=/css/theme-blue.css?1662767939 rel=stylesheet><link href=/css/variant.css?1662767939 rel=stylesheet><link href=/css/print.css?1662767939 rel=stylesheet media=print><script src=/js/jquery.min.js?1662767939></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=/getting-started/api/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/ style="color:#3d414d;font-family:novacento sans wide,helvetica,tahoma,geneva,arial,sans-serif;font-size:30px;font-weight:700;margin-top:-2px"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="110pt" height="100pt" viewBox="0 0 1116 1022"><g transform="translate(0.000000,1022.000000) scale(0.100000,-0.100000)" fill="#fff" stroke="none"><path d="M5175 8694c-372-40-646-124-955-289-93-50-98-53-185-109-79-52-172-124-270-211l-80-71-45 8c-119 24-255-17-338-1e2-138-139-147-353-21-513 96-123 314-160 462-81 67 36 141 120 166 187 29 76 29 214 1 280l-20 46 53 50c28 27 93 80 142 118 319 239 7e2 388 1106 431 123 13 410 13 524 0 455-52 915-256 1233-547l53-48-20-60c-10-33-22-71-25-85-4-21-24-33-121-74-514-217-929-608-1212-1141l-53-1e2v457 456l48 27c108 62 171 149 192 264 30 169-51 336-199 408-51 25-66 28-166 28-106 0-112-1-171-33-75-41-123-89-160-162-27-51-29-63-29-170s2-119 28-168c33-63 101-131 163-163l44-24v-841-841l-40-18c-52-24-145-121-172-182-17-38-21-68-22-148-1-88 2-107 26-157 83-177 275-258 466-196 58 18 77 31 138 92s73 79 87 132c33 119 16 254-44 341-29 42-94 1e2-137 122-12 7-20 16-17 21 3 4 12 46 21 92 24 130 72 290 126 428 43 108 204 408 250 465 4 6 34 44 65 85 242 316 561 565 903 704l64 26 41-39c22-22 67-53 1e2-68 53-25 71-28 160-28 91 0 106 3 158 30 136 68 213 202 205 353-8 147-77 257-2e2 317-61 31-197 45-259 27-35-9-39-8-80 30-24 23-60 55-79 73-29 26-92 75-185 143-5 4-30 20-55 36s-58 38-73 48c-42 29-250 134-305 154-26 10-51 20-57 24-30 20-248 87-363 111-303 65-595 83-867 53z"/><path d="M5901 4195c-67-15-98-31-144-74-84-77-97-212-31-314 45-69 1e2-95 357-168 114-32 150-82 110-150-36-61-165-89-246-55-43 17-84 67-97 117l-11 40-92-7c-51-3-94-8-96-10-8-7 20-111 40-150 66-124 204-185 388-171 213 17 321 115 321 290 0 165-78 239-320 302-175 45-220 73-206 131 20 79 210 94 271 22 14-17 29-44 32-60 5-27 9-29 36-24 16 3 61 6 99 6h70l-7 43c-4 23-14 59-22 80-21 53-104 123-166 142-75 23-209 28-286 10z"/><path d="M3570 4110v-80h135 135v-380-380h1e2 1e2v380 380h135 135v80 80h-370-370v-80z"/><path d="M4420 3731v-461h95 95v190 190h39c107 0 124-14 269-228l103-152h115c62 0 114 2 114 5s-41 69-90 148c-61 95-110 161-151 2e2-47 44-57 57-42 57 34 0 96 30 131 63 126 120 98 339-53 416-49 26-51 26-337 29l-288 4v-461zm5e2 281c25-12 39-28 49-58 13-37 12-44-5-80-10-21-30-44-44-50-14-7-89-15-167-19l-143-7v116 116h138c110 0 144-3 172-18z"/><path d="M5340 3730v-460h95 95v460 460h-95-95v-460z"/><path d="M6792 4138c-11-29-90-233-176-452-86-220-156-404-156-408 0-5 46-7 102-6l103 3 36 1e2 36 1e2h179 178l39-102 40-103h103c57 0 104 3 104 8 0 4-81 211-181 460l-181 452h-103-104l-19-52zm176-328c28-74 53-143 57-152 7-17-2-18-109-18-64 0-116 1-116 3 0 14 112 309 115 305 2-2 26-64 53-138z"/><path d="M9e2 2194v-466l243 4c275 5 316 14 399 88 174 153 186 548 22 730-82 90-163 109-466 110H9e2v-466zm455 277c51-23 91-69 107-124 19-65 16-261-5-323-19-55-56-97-1e2-113-16-6-80-11-143-11h-114v295 295h108c82 0 116-5 147-19z"/><path d="M8290 2575v-85h90 90v85 85h-90-90v-85z"/><path d="M6818 2587l-88-52v-67-68h-40-40v-70-70h39 38l5-212c6-252 13-278 80-308 48-22 140-26 201-9 34 9 37 13 37 47 0 72-11 113-29 108-55-16-69-17-85-1-14 14-16 43-16 196v179h60 60v70 70h-60-60v120c0 66-3 120-7 119-5 0-47-24-95-52z"/><path d="M7958 2587l-88-51v-68-68h-40-40v-70-70h39 39l4-217c3-245 9-268 78-304 40-22 141-26 203-8l39 10-7 72c-4 40-9 74-10 75-2 2-19-1-39-8-26-8-41-8-56 0-19 10-20 19-20 195v185h60 60v70 70h-60-60v120c0 66-3 120-7 120-5-1-47-24-95-53z"/><path d="M2013 2402c-151-54-227-166-227-332 1-206 121-337 320-348 157-9 267 51 334 182 33 64 35 74 35 165-1 82-4 104-26 151-37 79-81 125-156 162-83 41-198 49-280 20zm196-160c61-45 90-128 76-215-10-56-28-89-65-121-61-51-132-47-191 12-91 91-65 289 45 338 39 18 101 11 135-14z"/><path d="M2773 2402c-89-32-143-84-180-173-14-34-18-71-18-164 0-111 2-124 28-177 55-111 153-168 291-168 137 0 220 45 273 148 49 95 48 97-56 114l-89 14-11-36c-15-51-51-81-103-87-94-9-148 64-148 202 0 134 44 195 139 195 46 0 95-35 105-75 4-14 12-25 19-24 27 1 158 27 163 32 10 10-15 73-46 115-44 61-122 95-229 99-65 3-99-1-138-15z"/><path d="M4375 2408c-16-6-48-24-70-40l-40-29-3 31-3 30h-90-89v-335-335h95 95v203c0 111 4 219 9 240 24 102 152 141 191 59 9-18 14-103 18-264l5-238h87 88l4 223c3 189 6 227 21 254 38 70 120 90 163 39 24-27 24-29 24-272v-244h95 95v251c0 287-6 325-60 379-83 83-254 77-338-13l-23-24-37 37c-55 55-158 76-237 48z"/><path d="M5389 2404c-59-18-133-83-164-144s-48-168-39-245c14-127 67-215 158-263 46-25 61-27 161-27s115 2 161 27c70 37 144 128 131 162-3 7-42 18-88 25-78 12-85 12-94-5-26-47-63-74-102-74-68 0-118 45-137 123l-6 27h220 220v58c0 125-48 239-122 293-78 56-2e2 74-299 43zm178-150c29-18 49-51 58-91l7-33h-126-126v25c0 94 108 151 187 99z"/><path d="M6241 2406c-24-8-61-29-82-46l-39-31v36 35h-90-90v-335-335h94 95l3 223c4 258 8 275 84 309 54 23 91 18 125-18 24-25 24-28 27-270l3-244h95 95l-3 268c-3 257-4 269-26 315-33 65-90 99-180 103-40 2-84-2-111-10z"/><path d="M7292 2405c-81-23-130-67-157-144-11-31-11-41-2-41 7 0 45-6 85-14l73-14 15 30c20 40 73 61 129 52 50-7 72-27 81-71 7-35 18-30-156-69-202-46-250-89-250-221 0-42 6-67 25-99 63-107 255-127 371-39l32 24 6-34 7-35h96c87 0 94 2 88 18-30 71-35 115-35 296-1 264-11 298-104 345-62 31-221 39-304 16zm225-416c-4-49-11-67-33-90-69-72-173-58-190 27-10 53 23 74 181 112 22 6 42 10 44 11s1-26-2-60z"/><path d="M8836 2404c-167-53-255-209-226-397 19-127 75-206 180-256 48-23 67-26 160-26 91 0 112 3 155 24 59 30 126 94 154 149 70 138 39 341-68 434-87 77-242 108-355 72zm161-145c102-38 146-212 80-311-87-128-244-90-277 67s75 290 197 244z"/><path d="M9715 2404c-22-8-57-28-77-45l-38-30v36 35h-90-90v-335-335h94 95l3 223c3 257 8 275 83 308 52 23 94 17 127-18 23-24 23-29 26-269l3-244h95 96l-4 268c-3 264-3 268-28 317-20 38-37 55-75 74-60 31-160 38-220 15z"/><path d="M3312 2138c4-292 8-309 71-365 48-42 97-56 176-51 71 5 120 25 164 66l27 26v-42-42h90 90v335 335h-94-95l-3-223c-3-193-5-227-21-250-24-36-59-58-105-64-33-4-44-1-73 25l-34 30-3 241-3 241h-95-96l4-262z"/><path d="M8290 2065v-335h90 90v335 335h-90-90v-335z"/></g></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/js/lunr.min.js?1662767939></script><script src=/js/auto-complete.js?1662767939></script><script>var index_url="/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/js/search.js?1662767939></script></div><div id=homelinks><ul><li><a class=padding href=/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/getting-started/ title="Getting Started" class="dd-item parent"><a href=/getting-started/>Getting Started</a><ul><li data-nav-id=/getting-started/protocol/ title="TRISA Protocol" class=dd-item><a href=/getting-started/protocol/>TRISA Protocol</a></li><li data-nav-id=/getting-started/api/ title="TRISA API" class="dd-item active"><a href=/getting-started/api/>TRISA API</a></li><li data-nav-id=/getting-started/errors/ title="TRISA Errors and Rejections" class=dd-item><a href=/getting-started/errors/>TRISA Errors and Rejections</a></li><li data-nav-id=/getting-started/keys/ title="Key Handler Package" class=dd-item><a href=/getting-started/keys/>Key Handler Package</a></li></ul></li><li data-nav-id=/joining-trisa/ title="Joining TRISA" class=dd-item><a href=/joining-trisa/>Joining TRISA</a><ul><li data-nav-id=/joining-trisa/registration/ title=Registration class=dd-item><a href=/joining-trisa/registration/>Registration</a></li><li data-nav-id=/joining-trisa/trixo/ title="TRIXO Form" class=dd-item><a href=/joining-trisa/trixo/>TRIXO Form</a></li><li data-nav-id=/joining-trisa/pkcs12/ title="Anatomy of a PKCS12 file" class=dd-item><a href=/joining-trisa/pkcs12/>Anatomy of a PKCS12 file</a></li><li data-nav-id=/joining-trisa/ca/ title="Certificate Authority" class=dd-item><a href=/joining-trisa/ca/>Certificate Authority</a></li></ul></li><li data-nav-id=/secure-envelopes/ title="Secure Envelopes" class=dd-item><a href=/secure-envelopes/>Secure Envelopes</a><ul></ul></li><li data-nav-id=/data-payloads/ title="Data Payloads" class=dd-item><a href=/data-payloads/>Data Payloads</a><ul></ul></li><li data-nav-id=/ivms/ title="Working with IVMS101" class=dd-item><a href=/ivms/>Working with IVMS101</a><ul></ul></li><li data-nav-id=/testnet/ title="TestNet Integration and Development" class=dd-item><a href=/testnet/>TestNet Integration and Development</a><ul><li data-nav-id=/testnet/rvasps/ title="Robot VASPs" class=dd-item><a href=/testnet/rvasps/>Robot VASPs</a></li><li data-nav-id=/testnet/trisa-cli/ title="TRISA CLI" class=dd-item><a href=/testnet/trisa-cli/>TRISA CLI</a></li><li data-nav-id=/testnet/certs-cli/ title="Creating Test Certificates" class=dd-item><a href=/testnet/certs-cli/>Creating Test Certificates</a></li></ul></li><li data-nav-id=/gds/ title="Directory Service" class=dd-item><a href=/gds/>Directory Service</a><ul><li data-nav-id=/gds/api/ title="Using the GDS API" class=dd-item><a href=/gds/api/>Using the GDS API</a></li><li data-nav-id=/gds/members/ title="Accessing Members" class=dd-item><a href=/gds/members/>Accessing Members</a></li></ul></li><li data-nav-id=/contributing/ title=Contributing class=dd-item><a href=/contributing/>Contributing</a><ul><li data-nav-id=/contributing/how-to-contribute/ title="How to Contribute" class=dd-item><a href=/contributing/how-to-contribute/>How to Contribute</a></li><li data-nav-id=/contributing/license/ title=License class=dd-item><a href=/contributing/license/>License</a></li></ul></li><li data-nav-id=/reference/ title=Reference class=dd-item><a href=/reference/>Reference</a><ul><li data-nav-id=/reference/faq/ title=FAQ class=dd-item><a href=/reference/faq/>FAQ</a></li><li data-nav-id=/reference/glossary/ title=Glossary class=dd-item><a href=/reference/glossary/>Glossary</a></li><li data-nav-id=/reference/best-practices/ title="Best Practices" class=dd-item><a href=/reference/best-practices/>Best Practices</a></li></ul></li></ul><div id=shortcuts><div class=nav-title></div><ul><li><a class=padding href=https://github.com/trisacrypto/trisa><i class="fab fa-fw fa-github"></i> Version v1beta1</a></li><li><a class=padding href=https://pkg.go.dev/github.com/trisacrypto/trisa/pkg><i class="fas fa-book"></i> TRISA API Documentation</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://trisa.dev/getting-started/api/ selected>English</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3"><a itemprop=item href=/><span itemprop=name>Home</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="2"><a itemprop=item href=/getting-started/><span itemprop=name>Getting Started</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="1"><a itemprop=item href=/getting-started/api/ aria-disabled=true><span itemprop=name>TRISA API</span></a></li></ol></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#the-trisanetwork-service>The <code>TRISANetwork</code> Service</a></li><li><a href=#transfer-and-transferstream-rpcs><code>Transfer</code> and <code>TransferStream</code> RPCs</a><ul><li><a href=#secureenvelope><code>SecureEnvelope</code></a></li></ul></li><li><a href=#confirmaddress-rpc><code>ConfirmAddress</code> RPC</a></li><li><a href=#keyexchange-rpc><code>KeyExchange</code> RPC</a><ul><li><a href=#signingkey>SigningKey</a></li></ul></li><li><a href=#the-trisahealth-service-and-status-rpc>The <code>TRISAHealth</code> Service and <code>Status</code> RPC</a><ul><li><a href=#healthcheck><code>HealthCheck</code></a></li><li><a href=#servicestate><code>ServiceState</code></a></li></ul></li><li><a href=#trisa-api-in-go>TRISA API in Go</a></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>TRISA API</h1><p>The TRISA Network Protocol implementation exposes several RPCs needed to build TRISA into your organization&rsquo;s application, which are defined within <a href=https://github.com/trisacrypto/trisa/tree/main/proto>the protocol buffers</a>. All TRISA members must implement both services described by the TRISA protocol (the <code>TRISANetwork</code> service and the <code>TRISAHealth</code> service) to ensure that exchanges are conducted correctly and securely.</p><p>The protocol buffers can be compiled into the language of your choice. This section describes the protocol buffers for the <code>TRISANetwork</code> endpoint and the protocol buffer API in <a href=https://github.com/trisacrypto/trisa/tree/main/pkg/trisa/api/v1beta1>Go</a>.</p><div class="notices note"><div class=label>Note</div><p>You will need to download and install the protocol buffer compiler if you have not already.</p></div><h2 id=the-trisanetwork-service>The <code>TRISANetwork</code> Service</h2><p>The <code>TRISANetwork</code> service defines the peer-to-peer interactions between Virtual Asset Providers (VASPs) necessary to conduct compliance information exchanges.</p><p>The <code>TRISANetwork Service</code> has two primary RPCs, <code>Transfer</code> and <code>TransferStream</code>. <code>Transfer</code> and <code>TransferStream</code> allow VASPs to exchange compliance information before conducting a virtual asset transaction. <code>KeyExchange</code> allows public keys to exchange so that transaction envelopes can be encrypted and signed.</p><div class=highlight><pre class=chroma><code class=language-proto data-lang=proto><span class=kd>service</span> <span class=n>TRISANetwork</span> <span class=p>{</span><span class=err>
</span><span class=err></span>    <span class=k>rpc</span> <span class=n>Transfer</span><span class=p>(</span><span class=n>SecureEnvelope</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=n>SecureEnvelope</span><span class=p>)</span> <span class=p>{}</span><span class=err>
</span><span class=err></span>    <span class=k>rpc</span> <span class=n>TransferStream</span><span class=p>(</span><span class=n>stream</span> <span class=n>SecureEnvelope</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=n>stream</span> <span class=n>SecureEnvelope</span><span class=p>)</span> <span class=p>{}</span><span class=err>
</span><span class=err></span>    <span class=k>rpc</span> <span class=n>ConfirmAddress</span><span class=p>(</span><span class=n>Address</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=n>AddressConfirmation</span><span class=p>)</span> <span class=p>{}</span><span class=err>
</span><span class=err></span>    <span class=k>rpc</span> <span class=n>KeyExchange</span><span class=p>(</span><span class=n>SigningKey</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=n>SigningKey</span><span class=p>)</span> <span class=p>{}</span><span class=err>
</span><span class=err></span><span class=p>}</span><span class=err>
</span></code></pre></div><div class="notices note"><div class=label>Note</div><p>The <code>ConfirmAddress</code> RPC is not currently implemented.</p></div><h2 id=transfer-and-transferstream-rpcs><code>Transfer</code> and <code>TransferStream</code> RPCs</h2><p>The <code>Transfer</code> and <code>TransferStream</code> RPCs conduct the information exchange before a virtual asset transaction. The RPCs enable an originating VASP to send an encrypted transaction envelope to the beneficiary VASP containing a unique ID for the transaction, the encrypted transaction bundle, and metadata associated with the transaction cipher. In response, the beneficiary can validate the transaction request, then return the beneficiary&rsquo;s transaction information using the same unique transaction ID.</p><p>The <code>Transfer</code> RPC is a unary RPC for simple, single transactions. The <code>TransferStream</code> RPC is a bidirectional streaming RPC for high throughput transaction workloads.</p><h3 id=secureenvelope><code>SecureEnvelope</code></h3><p>A <code>SecureEnvelope</code> is the encrypted transaction envelope that is the outer layer of the TRISA information exchange protocol and facilitates the secure storage of Know Your Client (KYC) data in a transaction. The envelope specifies a unique id to reference the transaction out-of-band (e.g., in the blockchain layer). It provides the necessary information so only the originator and the beneficiary can decrypt the transaction data. For more information about Secure Envelopes, <a href=/secure-envelopes/>this section</a> of the documentation further describes this primary data structure for the TRISA exchange.</p><p>A <code>SecureEnvelope</code> message contains different types of metadata. <a href=/secure-envelopes/#the-anatomy-of-a-secure-envelope>The Anatomy of Secure Envelope</a> section of this documentation further describes the envelope metadata, cryptographic metadata, and an encrypted payload and HMAC signature within the <code>SecureEnvelope</code>.</p><div class=highlight><pre class=chroma><code class=language-proto data-lang=proto><span class=kd>message</span> <span class=nc>SecureEnvelope</span> <span class=p>{</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>id</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>bytes</span> <span class=n>payload</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>bytes</span> <span class=n>encryption_key</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>encryption_algorithm</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>bytes</span> <span class=n>hmac</span> <span class=o>=</span> <span class=mi>5</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>bytes</span> <span class=n>hmac_secret</span> <span class=o>=</span> <span class=mi>6</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>hmac_algorithm</span> <span class=o>=</span> <span class=mi>7</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=n>Error</span> <span class=n>error</span> <span class=o>=</span> <span class=mi>9</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>timestamp</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>bool</span> <span class=n>sealed</span> <span class=o>=</span> <span class=mi>11</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>public_key_signature</span> <span class=o>=</span> <span class=mi>12</span><span class=p>;</span><span class=err>
</span></code></pre></div><h2 id=confirmaddress-rpc><code>ConfirmAddress</code> RPC</h2><div class="notices note"><div class=label>Note</div><p>Address confirmation was initially described in the TRISA whitepaper as a mechanism to allow an originator VASP to establish that a beneficiary VASP has control of a crypto wallet address before sending transaction information with sensitive PII data. However, the details have not yet been defined, so the <code>ConfirmAddress</code> RPC is not currently implemented.</p></div><h2 id=keyexchange-rpc><code>KeyExchange</code> RPC</h2><p>The <code>KeyExchange</code> RPC allows VASPs to exchange public signing keys to facilitate transaction signatures if they have not already obtained them from the directory service.</p><h3 id=signingkey>SigningKey</h3><p><code>SigningKey</code> provides metadata for decoding a PEM encoded PKIX public key for RSA encryption and transaction signing. The SigningKey is a lightweight version of the certificate information stored in the <a href=https://vaspdirectory.net/%5D>Directory Service</a>.</p><div class=highlight><pre class=chroma><code class=language-proto data-lang=proto><span class=kd>message</span> <span class=nc>SigningKey</span> <span class=p>{</span><span class=err>
</span><span class=err></span>    <span class=c1>// x.509 metadata for reference without parsing the key
</span><span class=c1></span>    <span class=kt>int64</span> <span class=n>version</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>bytes</span> <span class=n>signature</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>signature_algorithm</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>public_key_algorithm</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span><span class=err>
</span><span class=err>
</span><span class=err></span>    <span class=c1>// Validity information
</span><span class=c1></span>    <span class=kt>string</span> <span class=n>not_before</span> <span class=o>=</span> <span class=mi>8</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>not_after</span> <span class=o>=</span> <span class=mi>9</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>bool</span> <span class=n>revoked</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span><span class=err>
</span><span class=err>
</span><span class=err></span>    <span class=c1>// The serialized public key to PKIX, ASN.1 DER form.
</span><span class=c1></span>    <span class=kt>bytes</span> <span class=n>data</span> <span class=o>=</span> <span class=mi>11</span><span class=p>;</span><span class=err>
</span><span class=err></span><span class=p>}</span><span class=err>
</span></code></pre></div><h2 id=the-trisahealth-service-and-status-rpc>The <code>TRISAHealth</code> Service and <code>Status</code> RPC</h2><p>The <code>TRISAHealth</code> service contains the <code>Status</code> RPC, which is optional but highly recommended for VASP members to implement. The Status endpoint allows TRISA members and the TRISA Directory Service to perform health checks with a VASP&rsquo;s TRISA Node and report the service conditions of the TRISA network. Because a down TRISA node will prevent travel rule compliant virtual asset transactions, the health service is intended to quickly identify network problems and notify members as quickly as possible.</p><div class="notices note"><div class=label>Note</div><p>The <code>TRISAHealth</code> service must also be behind mTLS so that the health check service can verify the identity certificates used for the TRISANetwork service.</p></div><div class=highlight><pre class=chroma><code class=language-proto data-lang=proto><span class=kd>service</span> <span class=n>TRISAHealth</span> <span class=p>{</span><span class=err>
</span><span class=err></span>    <span class=k>rpc</span> <span class=n>Status</span><span class=p>(</span><span class=n>HealthCheck</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=n>ServiceState</span><span class=p>)</span> <span class=p>{}</span><span class=err>
</span><span class=err></span><span class=p>}</span><span class=err>
</span></code></pre></div><h3 id=healthcheck><code>HealthCheck</code></h3><p><code>HealthCheck</code> specifies <code>attempts</code>, which is the number of failed health checks that proceeded the current check, and <code>last_checked</code>, which is the timestamp of the last health check, successful or otherwise.</p><div class=highlight><pre class=chroma><code class=language-proto data-lang=proto><span class=kd>message</span> <span class=nc>HealthCheck</span> <span class=p>{</span><span class=err>
</span><span class=err></span>    <span class=kt>uint32</span> <span class=n>attempts</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>last_checked_at</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span><span class=err>
</span><span class=err></span><span class=p>}</span><span class=err>
</span></code></pre></div><h3 id=servicestate><code>ServiceState</code></h3><p><code>ServiceState</code> returns the <code>status</code>, which is the Current service status as defined by the receiving system. The system must respond with the closest matching status in a best-effort fashion. Alerts will be triggered on service status changes if the system does not respond and the previous system state was not unknown. <code>not_before</code> and <code>not_after</code> are also returned; they suggest to the directory service when to recheck the health status.</p><div class=highlight><pre class=chroma><code class=language-proto data-lang=proto><span class=kd>message</span> <span class=nc>ServiceState</span> <span class=p>{</span><span class=err>
</span><span class=err></span>    <span class=kd>enum</span> <span class=n>Status</span> <span class=p>{</span><span class=err>
</span><span class=err></span>        <span class=n>UNKNOWN</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span><span class=err>
</span><span class=err></span>        <span class=n>HEALTHY</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span><span class=err></span>        <span class=n>UNHEALTHY</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span><span class=err>
</span><span class=err></span>        <span class=n>DANGER</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span><span class=err>
</span><span class=err></span>        <span class=n>OFFLINE</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span><span class=err>
</span><span class=err></span>        <span class=n>MAINTENANCE</span> <span class=o>=</span> <span class=mi>5</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=p>}</span><span class=err>
</span><span class=err>
</span><span class=err></span>    <span class=n>Status</span> <span class=n>status</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span><span class=err>
</span><span class=err></span>    <span class=c1>// When to check the health status again.
</span><span class=c1></span>    <span class=kt>string</span> <span class=n>not_before</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span><span class=err>
</span><span class=err></span>    <span class=kt>string</span> <span class=n>not_after</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span><span class=err>
</span><span class=err></span><span class=p>}</span><span class=err>
</span></code></pre></div><h2 id=trisa-api-in-go>TRISA API in Go</h2><p>The implementation of the TRISA Protocol Buffers in Go is compiled using <a href=https://grpc.io/docs/protoc-installation/><code>protoc</code></a> when <code>go generate ./...</code> is executed in the root of the repository. The <a href=https://github.com/trisacrypto/trisa/tree/main/pkg/trisa/api/v1beta1>compiled files</a> in the TRISA repository contain the TRISA Network Protocol implemented in Go.</p><p>The <code>TRISANetworkServer</code> is the server API for <code>TRISANetwork</code>, while the <code>TRISANetworkClient</code> is the client API for the <code>TRISANetwork</code> service. Both contain the <code>Transfer</code>, <code>TransferStream</code>, <code>ConfirmAddress</code>, and <code>KeyExchange</code> methods described above as <a href=/getting-started/api/#the-trisanetwork-service>RPCs</a> under the <code>TRISANetwork</code> service.</p><div class=highlight><pre class=chroma><code class=language-golang data-lang=golang><span class=kd>type</span> <span class=nx>TRISANetworkClient</span> <span class=kd>interface</span> <span class=p>{</span>
	<span class=nf>Transfer</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>in</span> <span class=o>*</span><span class=nx>SecureEnvelope</span><span class=p>,</span> <span class=nx>opts</span> <span class=o>...</span><span class=nx>grpc</span><span class=p>.</span><span class=nx>CallOption</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>SecureEnvelope</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
	<span class=nf>TransferStream</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>opts</span> <span class=o>...</span><span class=nx>grpc</span><span class=p>.</span><span class=nx>CallOption</span><span class=p>)</span> <span class=p>(</span><span class=nx>TRISANetwork_TransferStreamClient</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
	<span class=nf>ConfirmAddress</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>in</span> <span class=o>*</span><span class=nx>Address</span><span class=p>,</span> <span class=nx>opts</span> <span class=o>...</span><span class=nx>grpc</span><span class=p>.</span><span class=nx>CallOption</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>AddressConfirmation</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
	<span class=nf>KeyExchange</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>in</span> <span class=o>*</span><span class=nx>SigningKey</span><span class=p>,</span> <span class=nx>opts</span> <span class=o>...</span><span class=nx>grpc</span><span class=p>.</span><span class=nx>CallOption</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>SigningKey</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>TRISANetworkServer</span> <span class=kd>interface</span> <span class=p>{</span>
	<span class=nf>Transfer</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=o>*</span><span class=nx>SecureEnvelope</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>SecureEnvelope</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
	<span class=nf>TransferStream</span><span class=p>(</span><span class=nx>TRISANetwork_TransferStreamServer</span><span class=p>)</span> <span class=kt>error</span>
	<span class=nf>ConfirmAddress</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=o>*</span><span class=nx>Address</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>AddressConfirmation</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
	<span class=nf>KeyExchange</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=o>*</span><span class=nx>SigningKey</span><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>SigningKey</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>For further information, a <a href=https://github.com/trisacrypto/testnet/blob/main/pkg/rvasp/trisa.go>reference implementation</a> of the TRISA Network protocol is available in Go in the <a href=https://github.com/trisacrypto/testnet>TRISA TestNet Repository</a>,</p><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/getting-started/protocol/ title="TRISA Protocol"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/getting-started/errors/ title="TRISA Errors and Rejections"><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1662767939></script><script src=/js/perfect-scrollbar.min.js?1662767939></script><script src=/js/perfect-scrollbar.jquery.min.js?1662767939></script><script src=/js/jquery.svg.pan.zoom.js?1662767939></script><script src=/js/featherlight.min.js?1662767939></script><script src=/js/modernizr.custom-3.6.0.js?1662767939></script><script src=/js/mermaid.min.js?1662767939></script><script>typeof mermaid!='undefined'&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/js/relearn.js?1662767939></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-F9T1H8EJJS"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-F9T1H8EJJS')</script></body></html>